{
  "project": "NutriCoach",
  "version": "1.0.0",
  "features": {
    "recipe-recommendation-ai": {
      "feature": {
        "name": "AI Recipe Recommendation",
        "description": "Système de recommandation de recettes basé sur l'IA, les préférences nutritionnelles et les objectifs santé",
        "type": "ai-feature",
        "priority": "critical",
        "estimatedTime": "16h",
        "dependencies": ["user-profiles", "recipe-database"],
        "tags": ["ai", "nutrition", "recommendations", "core-feature"]
      },
      "agents": {
        "db-agent": {
          "required": true,
          "tasks": [
            {
              "id": "db-recipe-recommendation-schema",
              "type": "schema",
              "description": "Schéma pour les recommandations et historique",
              "priority": "critical",
              "estimatedTime": "2h",
              "useContext7": true,
              "spec": {
                "tables": [
                  {
                    "name": "recipe_recommendations",
                    "columns": [
                      { "name": "id", "type": "uuid", "primaryKey": true },
                      { "name": "user_id", "type": "uuid", "notNull": true },
                      { "name": "recipe_id", "type": "uuid", "notNull": true },
                      { "name": "ai_score", "type": "decimal(3,2)", "notNull": true },
                      { "name": "reason_tags", "type": "jsonb" },
                      { "name": "nutritional_match", "type": "jsonb" },
                      { "name": "created_at", "type": "timestamptz", "default": "now()" }
                    ]
                  },
                  {
                    "name": "user_feedback",
                    "columns": [
                      { "name": "id", "type": "uuid", "primaryKey": true },
                      { "name": "user_id", "type": "uuid", "notNull": true },
                      { "name": "recipe_id", "type": "uuid", "notNull": true },
                      { "name": "rating", "type": "integer", "notNull": true },
                      { "name": "feedback_text", "type": "text" },
                      { "name": "tried_recipe", "type": "boolean", "default": false }
                    ]
                  }
                ]
              }
            }
          ]
        },
        "module-agent": {
          "required": true,
          "tasks": [
            {
              "id": "ai-recommendation-service",
              "type": "ai-integration",
              "description": "Service d'IA pour les recommandations de recettes",
              "priority": "critical",
              "estimatedTime": "8h",
              "useContext7": true,
              "dependsOn": ["db-recipe-recommendation-schema"],
              "spec": {
                "integrationName": "RecipeRecommendation",
                "provider": "openai",
                "model": "gpt-4",
                "prompt": {
                  "system": "Tu es un nutritionniste expert spécialisé dans les recommandations personnalisées. Analyse les préférences utilisateur, objectifs santé, et contraintes alimentaires pour recommander des recettes adaptées.",
                  "user": "Utilisateur: {userProfile}, Objectifs: {nutritionalGoals}, Contraintes: {dietaryRestrictions}, Recettes disponibles: {availableRecipes}"
                },
                "context": {
                  "userProfile": "profil nutritionnel complet",
                  "availableRecipes": "base de données des recettes",
                  "nutritionalGoals": "objectifs santé personnalisés"
                }
              }
            },
            {
              "id": "api-recommendation-endpoints",
              "type": "api-endpoint",
              "description": "API pour les recommandations de recettes",
              "priority": "high",
              "estimatedTime": "3h",
              "dependsOn": ["ai-recommendation-service"],
              "spec": {
                "endpoints": [
                  {
                    "name": "getRecommendations",
                    "method": "GET",
                    "path": "/recommendations/recipes",
                    "authentication": true,
                    "parameters": [
                      { "name": "limit", "type": "number", "default": 10 },
                      { "name": "meal_type", "type": "string", "enum": ["breakfast", "lunch", "dinner", "snack"] },
                      { "name": "dietary_preference", "type": "string" }
                    ]
                  },
                  {
                    "name": "submitFeedback",
                    "method": "POST",
                    "path": "/recommendations/feedback",
                    "authentication": true
                  }
                ]
              }
            }
          ]
        },
        "ui-agent": {
          "required": true,
          "tasks": [
            {
              "id": "ui-recommendation-components",
              "type": "component",
              "description": "Composants UI pour les recommandations",
              "priority": "high",
              "estimatedTime": "6h",
              "dependsOn": ["api-recommendation-endpoints"],
              "spec": {
                "components": [
                  {
                    "name": "RecommendationCard",
                    "props": [
                      { "name": "recipe", "type": "Recipe", "optional": false },
                      { "name": "aiScore", "type": "number", "optional": false },
                      { "name": "reasonTags", "type": "string[]", "optional": true },
                      { "name": "onTryRecipe", "type": "function", "optional": false }
                    ],
                    "styling": {
                      "baseClasses": "bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden"
                    },
                    "accessibility": {
                      "ariaLabel": "Recipe recommendation card",
                      "role": "article"
                    }
                  },
                  {
                    "name": "RecommendationFeed",
                    "props": [
                      { "name": "recommendations", "type": "Recommendation[]", "optional": false },
                      { "name": "loading", "type": "boolean", "optional": true },
                      { "name": "onLoadMore", "type": "function", "optional": true }
                    ]
                  },
                  {
                    "name": "FeedbackModal",
                    "props": [
                      { "name": "recipe", "type": "Recipe", "optional": false },
                      { "name": "isOpen", "type": "boolean", "optional": false },
                      { "name": "onSubmit", "type": "function", "optional": false },
                      { "name": "onClose", "type": "function", "optional": false }
                    ]
                  }
                ]
              }
            }
          ]
        },
        "qa-agent": {
          "required": true,
          "tasks": [
            {
              "id": "qa-recommendation-tests",
              "type": "unit-tests",
              "description": "Tests pour le système de recommandations",
              "priority": "high",
              "estimatedTime": "4h",
              "dependsOn": ["ai-recommendation-service", "ui-recommendation-components"],
              "spec": {
                "target": "recipe-recommendations",
                "functions": [
                  {
                    "name": "generateRecommendations",
                    "testCases": {
                      "valid": { "userId": "123", "preferences": ["vegetarian"], "limit": 5 },
                      "expected": { "recommendations": "array", "totalScore": "number" },
                      "invalid": { "userId": null, "preferences": [], "limit": 0 },
                      "errorMessage": "Invalid user or preferences"
                    }
                  },
                  {
                    "name": "submitFeedback",
                    "testCases": {
                      "valid": { "userId": "123", "recipeId": "456", "rating": 5 },
                      "expected": { "success": true, "feedbackId": "string" },
                      "invalid": { "rating": 11 },
                      "errorMessage": "Rating must be between 1 and 10"
                    }
                  }
                ],
                "coverage": { "threshold": 85 }
              }
            },
            {
              "id": "qa-ai-performance-tests",
              "type": "performance-tests",
              "description": "Tests de performance pour l'IA",
              "priority": "medium",
              "estimatedTime": "2h",
              "spec": {
                "target": "ai-recommendation-service",
                "metrics": {
                  "responseTime": 2000,
                  "throughput": 100,
                  "accuracy": 85
                },
                "loadProfile": {
                  "users": 50,
                  "duration": "5m",
                  "rampUp": "1m"
                }
              }
            }
          ]
        },
        "doc-agent": {
          "required": true,
          "tasks": [
            {
              "id": "doc-recommendation-api",
              "type": "api-docs",
              "description": "Documentation API pour les recommandations",
              "priority": "medium",
              "estimatedTime": "2h",
              "dependsOn": ["api-recommendation-endpoints"],
              "spec": {
                "endpoints": [
                  {
                    "name": "getRecommendations",
                    "description": "Obtenir des recommandations personnalisées de recettes",
                    "parameters": [
                      { "name": "limit", "type": "number", "description": "Nombre de recommandations (max 50)" },
                      { "name": "meal_type", "type": "string", "description": "Type de repas souhaité" }
                    ],
                    "responseExample": {
                      "recommendations": [
                        {
                          "recipe": { "id": "123", "name": "Salade quinoa" },
                          "aiScore": 0.95,
                          "reasonTags": ["high-protein", "anti-inflammatory"],
                          "nutritionalMatch": { "protein": 85, "fiber": 90 }
                        }
                      ]
                    }
                  }
                ],
                "authentication": { "type": "JWT", "expiry": "24 heures" }
              }
            },
            {
              "id": "doc-user-guide-recommendations",
              "type": "user-guide",
              "description": "Guide utilisateur pour les recommandations IA",
              "priority": "medium",
              "estimatedTime": "3h",
              "spec": {
                "feature": "Recommandations IA",
                "audience": "Utilisateurs finaux de NutriCoach",
                "steps": [
                  {
                    "title": "Accéder aux recommandations",
                    "description": "Naviguez vers l'onglet 'Recommandations' depuis le tableau de bord",
                    "action": "Cliquez sur le bouton 'Découvrir des recettes'",
                    "screenshot": "recommendations-access.png"
                  },
                  {
                    "title": "Personnaliser vos préférences",
                    "description": "Ajustez vos préférences alimentaires et objectifs nutritionnels",
                    "action": "Utilisez les filtres disponibles (type de repas, régime, allergies)",
                    "tip": "Plus vous personnalisez, meilleures sont les recommandations"
                  },
                  {
                    "title": "Évaluer les recommandations",
                    "description": "Donnez votre avis sur les recettes recommandées",
                    "action": "Utilisez le système d'étoiles et commentaires",
                    "tip": "Vos évaluations améliorent les futures recommandations"
                  }
                ]
              }
            }
          ]
        }
      },
      "validation": {
        "crossAgentChecks": [
          {
            "name": "AI-Database Integration",
            "type": "data-consistency",
            "agents": ["module-agent", "db-agent"],
            "rules": [
              "Les scores IA sont correctement stockés",
              "Les contraintes de données sont respectées",
              "Les performances de requête sont optimales"
            ]
          },
          {
            "name": "API-UI Contract",
            "type": "api-contract",
            "agents": ["module-agent", "ui-agent"],
            "rules": [
              "Les types de recommandations sont cohérents",
              "Les composants gèrent tous les états de l'API",
              "La gestion d'erreur est complète"
            ]
          }
        ],
        "integrationTests": [
          "test-full-recommendation-flow",
          "test-feedback-loop",
          "test-performance-under-load"
        ],
        "qualityGates": [
          { "name": "Test Coverage", "type": "coverage", "threshold": 85, "blocking": true },
          { "name": "Performance API", "type": "performance", "threshold": 95, "blocking": true },
          { "name": "Security Scan", "type": "security", "threshold": 100, "blocking": true },
          { "name": "Accessibility", "type": "accessibility", "threshold": 95, "blocking": false }
        ]
      },
      "deployment": {
        "environment": "staging",
        "rollback": true,
        "monitoring": [
          "ai-response-times",
          "recommendation-accuracy",
          "user-engagement-metrics",
          "error-rates"
        ]
      }
    },

    "nutrition-tracking": {
      "feature": {
        "name": "Advanced Nutrition Tracking",
        "description": "Suivi nutritionnel avancé avec analyses, graphiques et recommandations personnalisées",
        "type": "crud-feature",
        "priority": "high",
        "estimatedTime": "12h",
        "dependencies": ["user-profiles"],
        "tags": ["nutrition", "tracking", "analytics", "health"]
      },
      "agents": {
        "db-agent": {
          "required": true,
          "tasks": [
            {
              "id": "db-nutrition-tracking-schema",
              "type": "schema",
              "description": "Schémas pour le suivi nutritionnel",
              "priority": "critical",
              "estimatedTime": "3h",
              "spec": {
                "tables": [
                  {
                    "name": "daily_nutrition_logs",
                    "columns": [
                      { "name": "id", "type": "uuid", "primaryKey": true },
                      { "name": "user_id", "type": "uuid", "notNull": true },
                      { "name": "date", "type": "date", "notNull": true },
                      { "name": "calories_consumed", "type": "integer", "default": 0 },
                      { "name": "macros", "type": "jsonb", "notNull": true },
                      { "name": "micros", "type": "jsonb" },
                      { "name": "water_intake_ml", "type": "integer", "default": 0 },
                      { "name": "created_at", "type": "timestamptz", "default": "now()" }
                    ],
                    "indexes": [
                      { "name": "idx_nutrition_user_date", "columns": ["user_id", "date"], "unique": true }
                    ]
                  },
                  {
                    "name": "food_entries",
                    "columns": [
                      { "name": "id", "type": "uuid", "primaryKey": true },
                      { "name": "daily_log_id", "type": "uuid", "notNull": true },
                      { "name": "food_item", "type": "text", "notNull": true },
                      { "name": "quantity", "type": "decimal(10,2)", "notNull": true },
                      { "name": "unit", "type": "text", "notNull": true },
                      { "name": "meal_type", "type": "text", "notNull": true },
                      { "name": "nutrition_data", "type": "jsonb", "notNull": true }
                    ]
                  }
                ]
              }
            }
          ]
        },
        "module-agent": {
          "required": true,
          "tasks": [
            {
              "id": "nutrition-calculation-service",
              "type": "business-logic",
              "description": "Service de calcul nutritionnel avancé",
              "priority": "high",
              "estimatedTime": "4h",
              "dependsOn": ["db-nutrition-tracking-schema"],
              "spec": {
                "serviceName": "NutritionCalculation",
                "domain": "nutrition",
                "operations": [
                  {
                    "name": "calculateDailyNutrition",
                    "description": "Calculer les totaux nutritionnels journaliers",
                    "parameters": [
                      { "name": "userId", "type": "string" },
                      { "name": "date", "type": "Date" }
                    ]
                  },
                  {
                    "name": "analyzeNutritionalBalance",
                    "description": "Analyser l'équilibre nutritionnel",
                    "parameters": [
                      { "name": "nutritionData", "type": "NutritionData" },
                      { "name": "goals", "type": "NutritionGoals" }
                    ]
                  }
                ],
                "rules": [
                  { "condition": "calories < 0", "message": "Les calories ne peuvent être négatives" },
                  { "condition": "macros.protein + macros.carbs + macros.fat !== macros.total", "message": "Incohérence dans les macronutriments" }
                ]
              }
            },
            {
              "id": "api-nutrition-endpoints",
              "type": "api-endpoint",
              "description": "API pour le suivi nutritionnel",
              "priority": "high",
              "estimatedTime": "3h",
              "dependsOn": ["nutrition-calculation-service"],
              "spec": {
                "endpoints": [
                  {
                    "name": "logFood",
                    "method": "POST",
                    "path": "/nutrition/log",
                    "authentication": true,
                    "validation": "foodEntrySchema"
                  },
                  {
                    "name": "getDailyLog",
                    "method": "GET",
                    "path": "/nutrition/daily/{date}",
                    "authentication": true
                  },
                  {
                    "name": "getNutritionAnalytics",
                    "method": "GET",
                    "path": "/nutrition/analytics",
                    "authentication": true,
                    "parameters": [
                      { "name": "period", "type": "string", "enum": ["week", "month", "quarter"] }
                    ]
                  }
                ]
              }
            }
          ]
        },
        "ui-agent": {
          "required": true,
          "tasks": [
            {
              "id": "ui-nutrition-dashboard",
              "type": "component",
              "description": "Dashboard de suivi nutritionnel",
              "priority": "high",
              "estimatedTime": "5h",
              "dependsOn": ["api-nutrition-endpoints"],
              "spec": {
                "components": [
                  {
                    "name": "NutritionDashboard",
                    "props": [
                      { "name": "dailyData", "type": "DailyNutritionData", "optional": false },
                      { "name": "goals", "type": "NutritionGoals", "optional": false },
                      { "name": "period", "type": "string", "optional": true }
                    ]
                  },
                  {
                    "name": "MacroChart",
                    "props": [
                      { "name": "macros", "type": "MacroData", "optional": false },
                      { "name": "goals", "type": "MacroGoals", "optional": false },
                      { "name": "chartType", "type": "string", "optional": true }
                    ]
                  },
                  {
                    "name": "FoodLogger",
                    "props": [
                      { "name": "onFoodAdded", "type": "function", "optional": false },
                      { "name": "suggestions", "type": "FoodSuggestion[]", "optional": true }
                    ]
                  }
                ]
              }
            }
          ]
        }
      },
      "validation": {
        "qualityGates": [
          { "name": "Test Coverage", "type": "coverage", "threshold": 80 },
          { "name": "Performance", "type": "performance", "threshold": 90 }
        ]
      }
    }
  }
}